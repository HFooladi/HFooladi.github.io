<!-- For footer -->
{% if site.footer_scripts %}
  {% for script in site.footer_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% else %}
  <script src="{{ '/assets/js/main.min.js' | relative_url }}"></script>
{% endif %}

<!-- For search -->
{% if site.search == true or page.layout == "search" %}
  {%- assign search_provider = site.search_provider | default: "lunr" -%}
  {%- case search_provider -%}
    {%- when "lunr" -%}
      {% include_cached search/lunr-search-scripts.html %}
    {%- when "google" -%}
      {% include_cached search/google-search-scripts.html %}
    {%- when "algolia" -%}
      {% include_cached search/algolia-search-scripts.html %}
  {%- endcase -%}
{% endif %}

<!-- For analytics -->
{% include analytics.html %}

<!-- For comments -->
{% include /comments-providers/scripts.html %}

<!-- For footer -->
{% if site.after_footer_scripts %}
  {% for script in site.after_footer_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% endif %}

<!-- For code blocks -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Wrap all pre elements with code inside
    document.querySelectorAll('pre > code').forEach(function(codeBlock) {
      const container = codeBlock.parentNode;
      const header = document.createElement('div');
      header.className = 'code-header';
      
      const button = document.createElement('button');
      button.className = 'copy-code-button';
      header.appendChild(button);
      
      // Insert header before pre element
      container.parentNode.insertBefore(header, container);
      
      button.addEventListener('click', function() {
        const code = codeBlock.textContent;
        navigator.clipboard.writeText(code).then(function() {
          button.classList.add('copied');
          setTimeout(function() {
            button.classList.remove('copied');
          }, 2000);
        }).catch(function(err) {
          console.error('Failed to copy: ', err);
        });
      });
    });
  });
  </script>